# ğŸ›  Creating a New Partition for LFS on Ubuntu (with Swap & Initramfs Notes)

## ğŸ“‹ 1. Preparation

Before touching partitions:

- **Backup important data** â€” partitioning mistakes can destroy data.
- **Know your target disk** â€” use `lsblk` or `sudo fdisk -l` to identify the correct device.
- **Decide on sizes**:
  - **LFS root partition**:  
    - Minimum: **10â€¯GB** (bare LFS build)  
    - Recommended: **30â€¯GB+** (room for sources, builds, and future growth)
  - **Swap partition**:  
    - Optional if you already have swap on the host.  
    - Recommended size:  
      - If RAM â‰¤ 4â€¯GB â†’ swap = 2Ã— RAM  
      - If RAM > 4â€¯GB â†’ swap â‰ˆ RAM size (or less if you rarely swap)

---

## ğŸ“‚ 2. Identify the Disk

Run:

```bash
lsblk -o NAME,SIZE,TYPE,MOUNTPOINT
```

Example:

```txt
NAME   SIZE TYPE MOUNTPOINT
sda    500G disk
â”œâ”€sda1 100G part /
â”œâ”€sda2  16G part [SWAP]
â””â”€sda3 384G part /home
sdb    256G disk
```

- In this example, `/dev/sdb` is unused â€” perfect for LFS.
- If you only have one disk, youâ€™ll need **unallocated space** or to shrink an existing partition.

---

## ğŸ–¥ 3. Launch `cfdisk`

```bash
sudo cfdisk /dev/sdX
```

Replace `X` with your disk letter (e.g., `sdb`).

When prompted for **label type**:

- **gpt** â†’ modern UEFI systems (recommended if your host boots in UEFI mode)
- **dos** â†’ legacy BIOS systems

You can check your boot mode with:

```bash
[ -d /sys/firmware/efi ] && echo "UEFI" || echo "BIOS"
```

---

## ğŸ› 4. Create the LFS Partition

Inside `cfdisk`:

1. Select **Free space**.
2. Choose **New** â†’ enter size (e.g., `30G`).
3. Choose **Type** â†’ select **Linux filesystem** (`83` in MBR, `8300` in GPT).
4. This will be your **LFS root** (e.g., `/dev/sdb1`).

---

## ğŸ’¾ 5. Create a Swap Partition (Optional)

If you want a dedicated swap for LFS:

1. Select remaining **Free space**.
2. Choose **New** â†’ enter size (e.g., `4G`).
3. Choose **Type** â†’ select **Linux swap** (`82` in MBR, `8200` in GPT).
4. This will be your **swap partition** (e.g., `/dev/sdb2`).

---

## ğŸ“ 6. Write Changes

- Select **Write**.
- Type `yes` to confirm.
- Select **Quit** to exit.

---

## ğŸ§¹ 7. Format the Partitions

Format the LFS root:

```bash
sudo mkfs.ext4 /dev/sdb1
```

Format the swap:

```bash
sudo mkswap /dev/sdb2
```

Activate swap immediately (optional):

```bash
sudo swapon /dev/sdb2
```

---

## ğŸ“Œ 8. Record Partition Names

Youâ€™ll need these later in `/etc/fstab` inside your LFS build:

- LFS root â†’ `/dev/sdb1`
- Swap â†’ `/dev/sdb2` (if created)

---

## ğŸ“¦ 9. About Initramfs (Advanced)

**Initramfs** is a small, temporary root filesystem loaded into memory at boot before the real root filesystem mounts.  
You **need** an initramfs if:

- Your root filesystem is on **LVM**, **RAID**, or **encrypted** storage.
- Your kernel lacks built-in drivers for your storage controller or filesystem.

For a **basic LFS on a plain partition**, you can boot without an initramfs by compiling all necessary drivers directly into the kernel.  
If you later move to LVM/RAID/encryption, youâ€™ll need to:

- Build an initramfs with `dracut` or `mkinitcpio`.
- Configure your bootloader to load it.

---

## ğŸ§  10. Example Partition Layout (GPT)

| Partition | Size  | Type            | Purpose         |
|-----------|-------|-----------------|-----------------|
| /dev/sdb1 | 30â€¯GB | Linux filesystem| LFS root        |
| /dev/sdb2 | 4â€¯GB  | Linux swap      | Swap space      |

---

## ğŸš€ 11. Next Steps

- Mount your LFS root:
  
  ```bash
  sudo mount /dev/sdb1 /mnt/lfs
  ```

- If using swap:
  
  ```bash
  sudo swapon /dev/sdb2
  ```

- Continue with **LFS Chapter 2.5** (Setting the $LFS variable).

---

ğŸ’¡ **Pro tip for reproducibility**:  
Since youâ€™re big on provenance and modular builds, you could script this entire process with `parted` or `sgdisk` so your partitioning is **repeatable** and **documented** â€” perfect for your branded LFS pipeline.
